{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "filter-schema.json",
  "title": "Dynamic Filter Schema",
  "description": "Schema for self-evolving filters based on discovered parameters",
  "type": "object",
  "properties": {
    "parameters": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "label", "type"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for this parameter"
          },
          "label": {
            "type": "string",
            "description": "Display label"
          },
          "type": {
            "type": "string",
            "enum": ["range", "select", "multiselect", "boolean", "text"],
            "description": "Filter input type"
          },
          "category": {
            "type": "string",
            "description": "Category grouping (welding, cutting, general, etc.)"
          },
          "unit": {
            "type": "string",
            "description": "Unit of measurement (mm, kg, etc.)"
          },
          "min": {
            "type": "number",
            "description": "Minimum value for range filters"
          },
          "max": {
            "type": "number",
            "description": "Maximum value for range filters"
          },
          "step": {
            "type": "number",
            "description": "Step increment for range filters"
          },
          "options": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "value": { "type": "string" },
                "label": { "type": "string" }
              }
            },
            "description": "Options for select/multiselect filters"
          },
          "occurrences": {
            "type": "integer",
            "description": "How many companies have this parameter"
          },
          "successScore": {
            "type": "number",
            "description": "How often this filter leads to successful contacts"
          },
          "addedAt": {
            "type": "string",
            "format": "date-time"
          },
          "discoveredFrom": {
            "type": "string",
            "description": "Source of this parameter (company ID, etc.)"
          }
        }
      }
    },
    "popularity": {
      "type": "object",
      "additionalProperties": {
        "type": "integer"
      },
      "description": "Map of filter ID to usage count"
    },
    "successMetrics": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "searches": { "type": "integer" },
          "clicks": { "type": "integer" },
          "contacts": { "type": "integer" },
          "conversionRate": { "type": "number" }
        }
      },
      "description": "Success metrics per filter"
    },
    "lastUpdated": {
      "type": "string",
      "format": "date-time"
    }
  }
}
